<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SPACEBIO</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header id="appHeader" class="app-header bgless">
    <div class="nav-left">
      <div class="brand">
        <div class="logo-dot"></div>
        <div class="brand-text">
          <strong>ASTROQUERY</strong>
          <span class="sub">NASA Space Apps Challenge</span>
        </div>
      </div>
    </div>

    <nav id="topNav" class="nav-center">
      <a href="#/" data-route="/">Search</a>
      <a href="#/learn" data-route="/learn">Learn</a>
      <a href="#/chat" data-route="/chat">AI Chat</a>
      <a href="#/graph" data-route="/graph">Knowledge Graph</a>
      <a href="#/simulator" data-route="/simulator">Simulator</a>
      <a href="#/deep-research" data-route="/deep-research">Deep Research Intelligence</a>
    </nav>

    <div class="nav-right">
      <div id="userAvatar" class="user-avatar" title="User Profile">
        <span id="avatarInitials">U</span>
      </div>
    </div>
  </header>

  <canvas id="gl"></canvas>

  <h1 class="title">ASTROQUERY</h1>

  <div id="search-layer">
    <div id="search-bar" role="search">
      <input id="q" placeholder="Search publications…" aria-label="Search publications" />
      <button id="filtersBtn" aria-expanded="false" aria-controls="filtersPanel">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" style="vertical-align:middle; margin-right:4px;"><path d="M1 3h12M3 7h8M5 11h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        Filters
      </button>
      <button id="goBtn">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" style="vertical-align:middle; margin-right:4px;"><circle cx="5.5" cy="5.5" r="4" stroke="currentColor" stroke-width="1.5"/><path d="M8.5 8.5l4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        Search
      </button>

      <div id="filtersPanel" class="popover" hidden>
        <div class="row">
          <label>Sections</label>
          <div id="sectionChips" class="chips"></div>
        </div>
        <div class="row">
          <label>Years</label>
          <div class="years">
            <input type="range" id="yMin" min="1990" max="2025" value="2005">
            <input type="range" id="yMax" min="1990" max="2025" value="2021">
            <span id="yearLabel">2005 – 2021</span>
          </div>
        </div>
        <div class="actions">
          <button id="clearFilters" class="ghost">Clear</button>
          <button id="closeFilters">Done</button>
        </div>
      </div>
    </div>
  </div>

  <section id="resultsHdr" class="hidden"></section>
  <main id="results" class="hidden" aria-live="polite"></main>


  <section id="page" aria-live="polite" style="position:relative; margin:80px auto 120px; width:min(1200px,92vw);"></section>

  <!-- Floating chat icon (bottom-left) -->
  <button id="chatFab" class="chat-fab" aria-label="Open mini chat" title="Open AI Chat">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M3 12a7 7 0 0 1 7-7h4a7 7 0 0 1 0 14h-2.2l-3.3 2.6c-.9.7-2.2-.1-2-1.2l.4-2.2H10A7 7 0 0 1 3 12Z"
            stroke="#cfe7ff" stroke-width="1.4"/>
    </svg>
  </button>

  <!-- Mini chat pop-up -->
  <div id="chatPopup" class="chat-popup" hidden>
    <header class="cp-head">
      <div class="cp-title">AI Chat</div>
      <div class="cp-actions">
        <button id="cpUndock" class="btn sm" title="Open full chat">⤢</button>
        <button id="cpClose" class="btn sm" title="Close">×</button>
      </div>
    </header>
    <div id="cpThread" class="cp-thread"></div>
    <div class="cp-input">
      <textarea id="cpInput" rows="2" placeholder="Ask me anything…"></textarea>
      <button id="cpSend" class="btn">Send</button>
    </div>
    <div class="cp-hint muted">Enter to send • Shift+Enter for newline</div>
  </div>

  <!-- Pop-up logic -->
  <script type="module" src="./chat-popup.js"></script>

  <script type="module" src="app.js"></script>
</body>
</html>
